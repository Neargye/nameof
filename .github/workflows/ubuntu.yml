name: ubuntu

on: [push, pull_request]

jobs:
  ubuntu:
    runs-on: ubuntu-20.04
    strategy:
      matrix:
        build: [Debug, Release]
        compiler: [g++7, g++8, g++9, g++10, clang++8, clang++9, clang++10]

    name: "${{matrix.os}}:${{matrix.compiler}}:${{matrix.build}}"
    steps:
    - uses: actions/checkout@v2

    - name: Configure CXX
      run: |
        export CXX=${{matrix.compiler}}
        ${CXX} --version

    - name: Create Build Environment
      run: |
        rm -rf build
        mkdir -p build
        cd build

    - name: Configure CMake
      run: cmake -DCMAKE_BUILD_TYPE=${{matrix.build}} ..

    - name: Build
      run: cmake --build . --config ${{matrix.build}}

    - name: Tests
      run: ctest --output-on-failure -C ${{matrix.build}}
